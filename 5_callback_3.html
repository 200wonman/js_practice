<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>



    <script>

        /*
            콜백지옥 체험
            : 가독성이 너~~~무 떨어진다.
        */

    // Callback Hell example
    class UserStorage {
        loginUser(id, password, onSuccess, onError) {
            setTimeout(() => {
                if (
                    (id === 'ellie' && password === 'dream') ||
                    (id === 'coder' && password === 'academy')
                ) {
                    onSuccess(id);
                } else {
                    onError(new Error('not found'));
                }
            }, 2000);
        }

        getRoles(user, onSuccess, onError) {
            setTimeout(() => {
                if (user === 'ellie') {
                    onSuccess({ name: 'ellie', role: 'admin' });
                } else {
                    onError(new Error('no access'));
                }
            }, 1000);
        }
    }



    const userStorage = new UserStorage();
    const id = prompt('enter your id');
    const password = prompt('enter your passrod');

    userStorage.loginUser(
        id,
        password,
        user => {
            userStorage.getRoles(
                user,
                userWithRole => {
                    alert(
                        `Hello ${userWithRole.name}, you have a ${userWithRole.role} role`
                    );
                },
                error => {
                    console.log(error);
                }
            );
        },
        error => {
            console.log(error);
        }
    );



</script>
    
    
    </body>
    
    </html>